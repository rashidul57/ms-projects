<!-- Code from d3-graph-gallery.com -->
<!DOCTYPE html>
<meta charset="utf-8">

<!-- Load d3.js -->
<!-- <script src="https://d3js.org/d3.v4.js"></script> -->
<script src="./libs/d3.min.js"></script>
<meta charset="utf-8">
<style> /* set the CSS */

.area {							
  fill: url(#area-gradient);					
  stroke-width: 0px;			
}

</style>
<!-- Create a div where the graph will take place -->
<div id="my_dataviz"></div>


<script>

window.onload = function () {
    draw();
}

async function draw() {
  width = 954
  height = 700
  
  const keys = d3.range(1790, 2000, 10);
  const [regions, states] = await Promise.all([
    FileAttachment("./data/census-regions.csv").text(),
    FileAttachment("./data/population.tsv").text()
  ]).then(([regions, states]) => [
    d3.csvParse(regions),
    d3.tsvParse(states, (d, i) => i === 0 ? null : ({name: d[""], values: keys.map(key => +d[key].replace(/,/g, ""))}))
  ]);
  const regionByState = new Map(regions.map(d => [d.State, d.Region]));
  const divisionByState = new Map(regions.map(d => [d.State, d.Division]));
  data = {keys, group: d3.group(states, d => regionByState.get(d.name), d => divisionByState.get(d.name))};


}





</script>